<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    body { font-family: 'Kanit', sans-serif; }
    #map { height: 300px; width: 100%; border-radius: 0.75rem; z-index: 1; margin-top: 10px; }
  </style>
</head>

<body class="bg-blue-50 min-h-screen">
  <div class="container mx-auto px-4 py-8 max-w-md">
    <div class="bg-white rounded-xl shadow-lg p-6">
      <h2 class="text-2xl font-bold text-center text-blue-600 mb-6">üìù ‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h2>

      <form id="repairForm" class="space-y-4">
        <input type="hidden" id="userId" name="userId">

        <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200 shadow-sm">
          <label class="block text-gray-700 font-bold mb-2">üì¢ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏∞‡πÑ‡∏£? *</label>
          <select name="category" id="category" required
            class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-lg">
            <option value="" disabled selected>-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏à‡∏¥‡πâ‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ --</option>
            <option value="‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞">üí° ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞ (‡πÑ‡∏ü‡∏î‡∏±‡∏ö/‡∏Å‡∏¥‡πà‡∏á‡πÑ‡∏°‡πâ‡∏û‡∏≤‡∏î)</option>
            <option value="‡∏õ‡∏£‡∏∞‡∏õ‡∏≤/‡∏ó‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏ô‡πâ‡∏≥">üö∞ ‡∏õ‡∏£‡∏∞‡∏õ‡∏≤ / ‡∏ó‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏ô‡πâ‡∏≥</option>
            <option value="‡∏ñ‡∏ô‡∏ô/‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡πâ‡∏≤">üõ£Ô∏è ‡∏ñ‡∏ô‡∏ô / ‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ä‡∏≥‡∏£‡∏∏‡∏î</option>
            <option value="‡∏Ç‡∏¢‡∏∞/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î">üóëÔ∏è ‡∏Ç‡∏¢‡∏∞ / ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î</option>
            <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">üìù ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
          </select>
        </div>

        <div>
          <label class="block text-gray-700 font-bold mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á *</label>
          <input type="text" name="name" id="name" required
            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
        </div>

        <div>
          <label class="block text-gray-700 font-bold mb-2">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ *</label>
          <input type="tel" name="phone" id="phone" required maxlength="10"
            oninput="this.value = this.value.replace(/[^0-9]/g, '')"
            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">
        </div>

        <div>
          <label class="block text-gray-700 font-bold mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ *</label>
          <textarea name="detail" id="detail" rows="3" required
            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞ ‡∏à‡∏∏‡∏î‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï"></textarea>
        </div>

        <div>
          <label class="block text-gray-700 font-bold mb-2">‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô *</label>
          <div class="flex items-center justify-center w-full">
            <label class="flex flex-col w-full h-32 border-4 border-blue-200 border-dashed hover:bg-gray-100 hover:border-gray-300 rounded-lg cursor-pointer">
              <div class="flex flex-col items-center justify-center pt-7">
                <p class="pt-1 text-sm tracking-wider text-gray-400">‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ üì∏</p>
              </div>
              <input type="file" name="image" id="imageInput" class="hidden" accept="image/*" capture="environment"
                onchange="previewImage(event)" required>
              <input type="hidden" name="photoUrl" id="photoUrl">
            </label>
          </div>
          <img id="preview" class="hidden w-full mt-4 rounded-lg shadow-md border border-gray-200" />
        </div>

        <div>
          <label class="block text-gray-700 font-bold mb-2">üìç ‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏∏‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏ (‡∏•‡∏≤‡∏Å‡∏´‡∏°‡∏∏‡∏î‡πÑ‡∏î‡πâ) *</label>
          
          <div id="map"></div>
          
          <div class="flex justify-between items-center mt-2">
             <span id="locationStatus" class="text-xs text-gray-500">‡∏£‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏¥‡∏Å‡∏±‡∏î...</span>
             <button type="button" onclick="getCurrentLocation()" class="text-xs bg-blue-100 text-blue-600 px-3 py-1 rounded-full">
               üéØ ‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏â‡∏±‡∏ô
             </button>
          </div>

          <input type="hidden" name="lat" id="lat">
          <input type="hidden" name="long" id="long">
        </div>

        <button type="submit" id="submitBtn"
          class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg mt-6 transform transition hover:scale-105">
          üöÄ ‡∏™‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°
        </button>
      </form>
    </div>
    <p class="text-center text-gray-500 text-xs mt-4">‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏• by Alieninburi</p>
  </div>

  <div id="loading" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50">
    <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-500"></div>
  </div>

  <script>
    // --- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö (‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) ---
    const WEBHOOK_URL = 'https://hook.eu1.make.com/8uj45pto8ouoba79ndgs8urhwork3ame';
    const IMGBB_API_KEY = '90bdd186ac4a75a080d137e88c123b84'; // ‡πÉ‡∏ä‡πâ Key ‡πÄ‡∏î‡∏¥‡∏°
    
    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡∏≠‡∏¥‡∏ô‡∏ö‡∏∏‡∏£‡∏µ)
    const defaultLat = 14.996; 
    const defaultLng = 100.327;
    let map, marker;

    window.onload = function() {
      initializeLiff();    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å LIFF ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
      autoSelectCategory();// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
      initMap();           // *‡πÄ‡∏û‡∏¥‡πà‡∏°* ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
    };

    // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏° ‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°) ---
    function initMap() {
      map = L.map('map').setView([defaultLat, defaultLng], 13);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Map data &copy; OpenStreetMap'
      }).addTo(map);

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏°‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏•‡∏≤‡∏Å‡πÑ‡∏î‡πâ
      marker = L.marker([defaultLat, defaultLng], {draggable: true}).addTo(map);

      // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏≤‡∏Å‡∏´‡∏°‡∏∏‡∏î ‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏≤‡∏Ñ‡πà‡∏≤‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô input lat/long (‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏á)
      marker.on('dragend', function(e) {
        updateInput(marker.getLatLng().lat, marker.getLatLng().lng);
      });

      // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà ‡πÉ‡∏´‡πâ‡∏¢‡πâ‡∏≤‡∏¢‡∏´‡∏°‡∏∏‡∏î‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏ô‡∏±‡πâ‡∏ô
      map.on('click', function(e) {
        marker.setLatLng(e.latlng);
        updateInput(e.latlng.lat, e.latlng.lng);
      });

      // ‡∏•‡∏≠‡∏á‡∏î‡∏∂‡∏á GPS ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
      getCurrentLocation();
    }

    function getCurrentLocation() {
      const status = document.getElementById('locationStatus');
      status.innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á GPS...";
      
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition((position) => {
          const lat = position.coords.latitude;
          const lng = position.coords.longitude;
          
          // ‡∏¢‡πâ‡∏≤‡∏¢‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏∏‡∏î‡πÑ‡∏õ‡∏à‡∏∏‡∏î‡∏ô‡∏±‡πâ‡∏ô
          map.setView([lat, lng], 18);
          marker.setLatLng([lat, lng]);
          
          updateInput(lat, lng); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤ Input
          status.innerText = "‚úÖ ‡πÄ‡∏à‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß (‡∏•‡∏≤‡∏Å‡∏´‡∏°‡∏∏‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ)";
          status.className = "text-xs text-green-600 font-bold";
        }, (err) => {
          status.innerText = "‚ùå ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ GPS (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≤‡∏Å‡∏´‡∏°‡∏∏‡∏î‡πÄ‡∏≠‡∏á)";
          status.className = "text-xs text-red-500";
        }, {enableHighAccuracy: true});
      } else {
        status.innerText = "‚ùå ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö GPS";
      }
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏≠‡∏≤‡∏Ñ‡πà‡∏≤‡πÉ‡∏™‡πà Input (‡∏™‡∏∞‡∏û‡∏≤‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà -> ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°)
    function updateInput(lat, lng) {
      document.getElementById('lat').value = lat.toFixed(6);
      document.getElementById('long').value = lng.toFixed(6);
    }

    // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏° (‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÑ‡∏ß‡πâ) ---
    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(String(reader.result).split(',')[1]);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    async function uploadToImgBB(file) {
      const base64 = await fileToBase64(file);
      const fd = new FormData();
      fd.append('image', base64);
      const res = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, { method: 'POST', body: fd });
      const data = await res.json();
      if (!data || !data.success) throw new Error('ImgBB Upload Failed');
      return data.data.url;
    }

    async function initializeLiff() {
      try {
        await liff.init({ liffId: "2009072405-2lzKZtgB" });
        if (liff.isLoggedIn()) {
          const profile = await liff.getProfile();
          document.getElementById('userId').value = profile.userId;
        } else {
          liff.login();
        }
      } catch (err) { console.error("LIFF Error", err); }
    }

    function autoSelectCategory() {
      try {
        const urlParams = new URLSearchParams(window.location.search);
        const type = urlParams.get('type');
        const dropdown = document.getElementById('category');
        if (type === 'electric') dropdown.value = '‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞';
        else if (type === 'water') dropdown.value = '‡∏õ‡∏£‡∏∞‡∏õ‡∏≤/‡∏ó‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏ô‡πâ‡∏≥';
        else if (type === 'road') dropdown.value = '‡∏ñ‡∏ô‡∏ô/‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡πâ‡∏≤';
        else if (type === 'trash') dropdown.value = '‡∏Ç‡∏¢‡∏∞/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î';
        else if (type === 'other') dropdown.value = '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
        
        if(type) dropdown.style.backgroundColor = "#e0f2fe";
      } catch (e) { console.error(e); }
    }

    function previewImage(event) {
        const file = event.target.files[0];
        if(file){
            const reader = new FileReader();
            reader.onload = function(e){
                const output = document.getElementById('preview');
                output.src = e.target.result;
                output.classList.remove('hidden');
            }
            reader.readAsDataURL(file);
        }
    }

    // --- ‡∏™‡πà‡∏ß‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Submit Logic ‡πÄ‡∏î‡∏¥‡∏°) ---
    document.getElementById('repairForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const lat = document.getElementById('lat').value;
      const lng = document.getElementById('long').value;
      const category = document.getElementById('category').value;
      const phone = document.getElementById('phone').value;

      // Validation
      if (!category) { Swal.fire('‡∏•‡∏∑‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°', 'warning'); return; }
      if (!lat || !lng) { Swal.fire('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏û‡∏¥‡∏Å‡∏±‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏¥‡πâ‡∏°‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà', 'warning'); return; }
      if (phone.length < 9) { Swal.fire('‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ú‡∏¥‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö', 'warning'); return; }

      document.getElementById('loading').classList.remove('hidden');
      document.getElementById('submitBtn').disabled = true;

      try {
        const imageInput = document.getElementById('imageInput');
        // ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
        const url = await uploadToImgBB(imageInput.files[0]);
        document.getElementById('photoUrl').value = url;

        // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á Webhook (‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏°)
        const formData = new FormData(this);
        formData.set('photoUrl', url);
        formData.delete('image'); // ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå binary ‡∏≠‡∏≠‡∏Å ‡∏™‡πà‡∏á‡πÅ‡∏Ñ‡πà link

        // ‡∏™‡πà‡∏á‡πÑ‡∏õ Make
        const response = await fetch(WEBHOOK_URL, { method: 'POST', body: formData });

        if (response.ok) {
          Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', '‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success').then(() => {
            if (window.liff && liff.isInClient()) liff.closeWindow();
            else window.location.reload();
          });
        } else {
          throw new Error('Webhook Error');
        }
      } catch (error) {
        console.error(error);
        Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà', 'error');
      } finally {
        document.getElementById('loading').classList.add('hidden');
        document.getElementById('submitBtn').disabled = false;
      }
    });
  </script>
</body>
</html>
